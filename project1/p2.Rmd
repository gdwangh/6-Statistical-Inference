---
title: "the project 1 part 2"
author: "wangh"
date: "Saturday, August 16, 2014"
output: html_document
---
analyze the ToothGrowth data in the R datasets package

#### Load the ToothGrowth data
```{r,fig.height=3}
library(datasets)
data(ToothGrowth)
ToothGrowth$dose=as.factor(ToothGrowth$dose)
```
```{r,echo=FALSE}
boxplot(len ~ dose, data = ToothGrowth,
        boxwex = 0.25, at = 1:3 - 0.2,
        subset = supp == "VC", col = "yellow",
        main = "Tooth Growth",
        xlab = "dose(mg)",
        ylab = "tooth length",
        xlim = c(0.5, 3.5), ylim = c(0, 35), yaxs = "i")
boxplot(len ~ dose, data = ToothGrowth, add = TRUE,
        boxwex = 0.25, at = 1:3 + 0.2,
        subset = supp == "OJ", col = "orange")
legend("bottomright", c("VC", "OJ"), fill = c("yellow", "orange"))

ag<-rbind(aggregate(len~.,data=ToothGrowth, mean),data.frame(supp="-", aggregate(len~dose,data=ToothGrowth, mean)))
xtabs(len~., data=ag)
```

### Tooth Growth vs supp when dose in (0.5,1)
```{r}
g_OJ<- ToothGrowth[ToothGrowth$supp=="OJ" & ToothGrowth$dose %in% c(0.5,1),"len"] 
g_VC<- ToothGrowth[ToothGrowth$supp=="VC" & ToothGrowth$dose %in% c(0.5,1),"len"]
```
confidence interval and test the hypothesis: 
```{r}
alpha<-0.05; 
tt<-t.test(g_OJ,g_VC); tt
```
For t>0, confidence interval limits >0, H0:miu_OJ = miu_VC VS. Ha: miu_OJ > miu_VC
```{r}
qt(1-alpha, 36.55)
qt(1-alpha/2, 36.55)
```
TS(t = `r tt$statistic`) > qt(1-alpha,`r tt$parameter`)( = `r qt(1-alpha,tt$parameter)`), so H0 is rejected. 

##### conclusion: by 95% confidence interval, tooth growth by OJ is larger than by VC when dose is 0.5 or 1.

### Tooth Growth vs supp when dose=2
```{r}
g_OJ<- ToothGrowth[ToothGrowth$supp=="OJ" & ToothGrowth$dose==2,"len"] 
g_VC<- ToothGrowth[ToothGrowth$supp=="VC" & ToothGrowth$dose==2,"len"]
tt<-t.test(g_OJ,g_VC); tt
```
t<0, test the hypothes is: H0:miu_OJ = miu_VC versus Ha: miu_OJ < miu_VC
```{r}
qt(1-alpha,14.04)
qt(1-alpha/2,14.04)
```

TS(t = `r tt$statistic`) < qt(1-alpha,`r tt$parameter`)( = `r qt(1-alpha/2,tt$parameter)`), so, H0 is rejected.

##### conclusion: 95% confidence interval, tooth growth by OJ is smaller than by VC when dose is 2.
